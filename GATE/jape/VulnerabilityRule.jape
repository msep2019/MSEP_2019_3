Imports: {
	import static gate.Utils.*;
}
Phase: 		getVulnerability
Input: 		Lookup Sentence Token Split  
Options: 	control = brill

Rule: 		VulnerabilityRule
Priority: 	30
(
	{Lookup.majorType == "SoSSec", Lookup.minorType == "Behaviour"}
): behaviour
(
	{Lookup.majorType == "SoSSec", Lookup.minorType == "ConnectWord", Lookup._string == "-Vul-"}
)
(
	{Lookup.majorType == "SoSSec", Lookup.minorType == "Vulnerability"}
): vul
-->
{
	gate.AnnotationSet vul = (gate.AnnotationSet)bindings.get("vul");
	gate.Annotation vulAnn = (gate.Annotation)vul.iterator().next();
	gate.FeatureMap features = Factory.newFeatureMap();

	features.put("rule", "VulnerabilityRule");

	gate.AnnotationSet behaviour = (gate.AnnotationSet)bindings.get("behaviour");
	gate.Annotation behaviourAnn = (gate.Annotation)behaviour.iterator().next();
	
	features.put("Behaviour" ,stringFor(doc, behaviourAnn));
	
	outputAS.add(vul.firstNode(), vul.lastNode(), "Vulnerability", features);
}